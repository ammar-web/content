commonfields:
  id: Netcraft
  version: -1
name: Netcraft
display: Netcraft
category: Utilities
description: Netcraft takedown, submission and screenshot management.
sectionOrder:
- Connect
- Collect
configuration:
- display: Takedown Server URL
  name: takedown_url
  defaultvalue: "https://takedown.netcraft.com/api/v1"
  type: 0
  required: true
  section: Connect
- display: Submission Server URL
  name: submission_url
  defaultvalue: "https://report.netcraft.com/api/v3"
  type: 0
  required: true
  section: Connect
- name: credentials
  type: 9
  required: true
  displaypassword: API Key
  hiddenusername: true
  section: Connect
- name: region
  type: 0
  required: true
  displaypassword: Region
  section: Connect
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  section: Connect
  advanced: true
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  section: Connect
  advanced: true
  required: false

- display: Fetch incidents
  name: isFetch
  type: 8
  section: Collect
  required: false
- display: Incident type
  name: incidentType
  type: 13
  section: Collect
  defaultvalue: Netcraft Attack
  required: false
- defaultvalue: '10'
  display: Maximum number of incidents per fetch
  name: max_fetch
  type: 0
  section: Collect
  required: false
- defaultvalue: 3 days
  display: First fetch time
  name: first_fetch
  type: 0
  section: Collect
  required: true
- defaultvalue: None
  display: Mirroring Direction
  name: mirror_direction
  options:
  - None
  - Incoming
  - Outgoing
  - Incoming And Outgoing
  required: false
  type: 15
- defaultvalue: '1'
  display: 'Incidents Fetch Interval'
  name: incidentFetchInterval
  type: 19
  section: Collect
  advanced: true
  required: false

script:
  commands:
  - name: get-modified-remote-data
    arguments:
    - default: false
      description: Date string representing the local time. The incident is only returned if it was modified after the last update time.
      isArray: false
      name: lastUpdate
      required: false
      secret: false
    description: |
      Get the list of incidents (takedowns) that were modified since the last update time.
      This method is used for debugging purposes. The get-modified-remote-data command
      is used as part of the Mirroring feature that was introduced in Cortex XSOAR version 6.1.
  - name: get-remote-data
    arguments:
    - description: The remote incident (takedown) ID.
      name: id
      required: true
    - defaultValue: '0'
      description: The UTC timestamp in seconds of the last update. The incident (takedown) is only updated if it was modified after the last update time.
      name: lastUpdate
    description: Gets remote incident (takedown) data. This method does not update the current incidents, and should be used for debugging purposes only.
  - name: update-remote-system
    description: Updates the remote incident with local incident changes. This method
      is only used for debugging purposes and will not update the current incident.

  - name: 'netcraft-attack-report'
    description: |
      Report a new attack or authorise an existing attack in the Takedown service.
      If a takedown for the attack already exists in the system it will be authorised, otherwise, a new takedown will be added and authorised.
    arguments:
    - name: attack
      required: true
      description: The location of the attack to take down, e.g. a phishing URL, or a fraudulent email address.
    - name: comment
      required: true
      description: 	The reason for the report, such as a description of the attack.
    - description: The brand to report the takedown under. If no brand is specified, the brand of the provided "region" will be used.
      name: brand
    - defaultValue: phishing_url
      description: |
        The type of attack being reported.
        Run the command "netcraft-attack-type-list" to get a list of available types, use the "Name" field of the type for this argument.
      name: attack_type
    - auto: PREDEFINED
      description: |
        Set to "true" if the attack is not currently active.
        This will place the takedown directly into the "Inactive (Monitoring)" status, which can be used to monitor suspicious sites.
      name: inactive
      defaultValue: 'false'
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: |
        If set to true, Netcraft will be authorised to start the takedown as soon as the report has been processed.
        If set to false, the takedown will only be authorised if you have automatic authorisation enabled for the given attack type, or if the takedown is manually authorised later through the web interface.
      name: force_auth
      defaultValue: 'true'
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: |
        Should be set to true if the reported content contains or is related to a computer virus.
        This is used to determine the correct attack type in the case where the type parameter has not been provided.
        This argument is required for all malware attacks where the type parameter has not been provided.
      name: malware
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      defaultValue: 'false'
      description: |
        Should be set to true if you believe that the domain name has been registered as part of the fraud. 
        This will ensure that the registrar is contacted to seek suspension of the domain name.
      name: suspected_fraud_domain
      predefined:
      - 'true'
      - 'false'
    # - description: |
    #     "The password to extract any archived evidence provided via the evidence\_\
    #     parameter, if necessary."
    #   name: password
    # AWAITING TPM RESPONSE 
    - description: |
        The URL where the phishkit archive was found.
        This parameter is required for attacks of type "phishkit_email".
      name: phishkit_fetch_url
    - description: |
        The URL of the phishing attack which uses the referenced phishkit.
        This parameter is required for attacks of type "phishkit_email" and/or "phishkit_archive".
      name: phishkit_phish_url
    - description: A free-text field which can be used to keep track of particular attacks.
      name: customer_label
    - description: A comma-separated list of tags to apply to the attack.
      isArray: true
      name: tags
    - description:
        The name of the region to create a takedown under.
        If not provided the Region specified in the instance configuration will be used
      name: region
    outputs: []

  - name: 'netcraft-takedown-list'
    arguments:
    - name: statuses
      description: |
        Multiple values may be provided as a comma-separated list.
      isArray: true
      auto: PREDEFINED
      predefined:
      - unverified
      - inactive_monitoring
      - verified
      - contacted_hosting
      - contacted_police
      - contacted_upstream
      - resolved_monitoring
      - resolved
      - stale
      - invalid
    - name: url
      description: |
        ''
    - name: false_positive
      description: |
        ''
      auto: PREDEFINED
      predefined:
      - 'true'
      - 'false'
    - name: ip
      description: |
        ''
    - description: |
        Filter to takedowns that were submitted before the specified takedown
        ID.
      name: id_before
    - description: |
        Filter to takedowns that were submitted after the specified takedown
        ID.When using this parameter we recommend that you also set the sort parameter
        to id to ensure that no results are missed.
      name: id_after
    - description: |
        "Filter to takedowns that were submitted on or after the date/time\
        \ provided.Values should be supplied as YYYY-MM-DD HH:MM:SS\_in UTC. If no time\
        \ information is provided, the system will default to YYYY-MM-DD 00:00:00. Relative\
        \ date/time formats are also supported, for example\_5 days ago,\_and monday\
        \ this week"
      name: date_from
    - description: |
        "Filter to takedowns that were submitted on or before the date/time\
        \ provided.Values should be supplied as YYYY-MM-DD HH:MM:SS\_in UTC. If no time\
        \ information is provided, the system will default to YYYY-MM-DD 00:00:00. Relative\
        \ date/time formats are also supported, for example\_5 days ago,\_and monday\
        \ this week"
      name: date_to
    - description: |
        Filter to takedowns that were reported by the given user.
      name: reporter_email
    - description: |
        ''
      name: report_source
    - description: |
        "Add description that the user can get the values by running the\
        \ command \u201Cattack-type-list\u201D"
      isArray: true
      name: attack_types
    - description: |
        "yes\_- The takedown has been authorised.yes:customer\_- The takedown\
        \ has been authorised by you.yes:netcraft\_- The takedown has been authorised\
        \ by Netcraft.no\_- The takedown has not been authorised."
      name: auth_given
    - description: |
        "yes\_- The takedown has been escalated.yes:customer\_- The takedown\
        \ has been escalated by you.yes:netcraft\_- The takedown has been escalated\
        \ by Netcraft.no\_- The takedown has not been escalated."
      name: escalated
    - defaultValue: Status
      description: |
        Default value - Status
      name: sort
    - defaultValue: asc
      description: |
        Default value - asc
      name: sort_direction
    - description: |
        Default value 50, max value 100000
      name: limit
    - auto: PREDEFINED
      description: |
        Default value false.Add description that the max records = 100,000
      name: all_result
      predefined:
      - 'true'
      - 'false'
    - description: |
        ''
      name: region
    outputs: []
    description: |
      ''
  - name: 'netcraft-takedown-update'
    arguments:
    - name: takedown_id
      description: |
        ''
      required: true
    - name: customer_label
      description: |
        ''
    - name: description
      description: |
        ''
    - name: brand
      description: |
        ''
    - auto: PREDEFINED
      description: |
        ''
      name: suspected_fraud_domain
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: |
        ''
      name: suspected_fraud_hostname
      predefined:
      - 'true'
      - 'false'
    - description: |
        "Items Enum:\_\"coronavirus\"\_\"smishing\"\_\"fake-shop-logo\"\_\
        \"ukraine\"\_\"traffic_distribution_system\"\_\"prometheus_tds\"\_\"generic-fake-shop\"\
        \_\"google-ads\""
      isArray: true
      name: add_tags
    - description: |
        "Items Enum:\_\"coronavirus\"\_\"smishing\"\_\"fake-shop-logo\"\_\
        \"ukraine\"\_\"traffic_distribution_system\"\_\"prometheus_tds\"\_\"generic-fake-shop\"\
        \_\"google-ads\""
      isArray: true
      name: remove_tags
    - description: |
        ''
      name: region
    outputs: []
    description: |
      ''
  - name: 'netcraft-takedown-escalate'
    arguments:
    - name: takedown_id
      required: true
      description: |
        ''
    description: |
      ''
    outputs: []
  - name: 'netcraft-takedown-note-create'
    arguments:
    - description: |
        ''
      name: takedown_id
      required: true
    - description: |
        ''
      name: note_text
      required: true
    - auto: PREDEFINED
      description: |
        'Default: trueWhen set to true, the note will also be raised to our
        operations team for further investigation. This should be set if you require
        a Netcraft staff member to read and respond to your note.'
      name: notify
      predefined:
      - 'true'
      - 'false'
    description: |
      ''
    outputs: []
  - name: 'netcraft-takedown-note-list'
    arguments:
    - description: |
        ''
      name: takedown_id
    - description: |
        ''
      name: author_mail
    - defaultValue: '50'
      description: |
        Default value - 50
      name: limit
    - auto: PREDEFINED
      description: |
        Default - false
      name: all_results
      predefined:
      - 'true'
      - 'false'
    description: |
      ''
    outputs: []
  - name: 'netcraft-attack-type-list'
    arguments:
    - auto: PREDEFINED
      description: |
        Filter to attack types where automated takedowns are available.
      name: automated
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: |
        Filter to attack types which you have chosen to escalate to managed
        takedowns after the configured escalation period.
      name: auto_escalation
      predefined:
      - 'true'
      - 'false'
    - auto: PREDEFINED
      description: |
        Filter to attack types which you have chosen to automatically authorize
        takedowns against.
      name: auto_authorise
      predefined:
      - 'true'
      - 'false'
    - description: |
        ''
      name: region
    - description: |
        Default value 50
      name: limit
    - auto: PREDEFINED
      description: |
        Default value false.
      name: all_result
      predefined:
      - 'true'
      - 'false'
    description: |
      ''
    outputs: []
  - name: 'netcraft-file-report-submit'
    polling: true
    arguments:
    - description: |
        ''
      name: reporter_email
      required: true
    - description: |
        'The format of content_file is A base64 encoded string of the file"files":
        [{"content": "file_content","filename": "file_name"}]The purpose of this argument
        is to support reporting of multiple files with entry_id OR single file by file_content&file_name'
      name: file_content
    - description: |
        ''
      name: file_name
    - description: |
        ''
      isArray: true
      name: entry_id
    - description: |
        ''
      name: reason
    - auto: PREDEFINED
      description: |
        "Default value = trueIf the user changed to false we will not \_\
        execute the polling mechanism."
      name: polling
      predefined:
      - 'true'
      - 'false'
    - description: |
        Default 30
      name: interval_in_seconds
    - description: |
        Default 600
      name: timeout_in_seconds
    description: |
      ''
    outputs: []
  - name: 'netcraft-url-report-submit'
    arguments:
    - description: |
        ''
      name: reporter_email
      required: true
    - description: |
        ''
      isArray: true
      name: urls
      required: true
    - description: |
        ''
      name: reason
    - auto: PREDEFINED
      description: |
        "Default value = trueIf the user changed to false we will not \_\
        execute the polling mechanism."
      name: polling
      predefined:
      - 'true'
      - 'false'
    - description: |
        Default 30
      name: interval_in_seconds
    - description: |
        Default 600
      name: timeout_in_seconds
    description: |
      ''
    outputs: []
  - name: 'netcraft-email-report-submit'
    arguments:
    - description: |
        ''
      name: reporter_email
      required: true
    - description: |
        Either a plain text string of the malicious mail in MIME format or
        if the password paramater is provided, a base64 encoded AES-256-CBC encrypted
        mail in MIME format. Max message size is 20MiB.
      name: message
      required: true
    - description: |
        The password used to encrypt/decrypt the MIME mail. Should not be
        provided if the mail is not encrypted.
      name: password
    - auto: PREDEFINED
      description: |
        "Default value = trueIf the user changed to false we will not \_\
        execute the polling mechanism."
      name: polling
      predefined:
      - 'true'
      - 'false'
    - description: |
        Default 30
      name: interval_in_seconds
    - description: |
        Default 600
      name: timeout_in_seconds
    description: |
      ''
    outputs: []
  - name: 'netcraft-submission-list'
    arguments:
    - description: |
        "An optional argument to get a specific submission.In case that the\
        \ user provided this value we will execute the \u201Cget submission details\u201D\
        \_request, and ignore all the others arguments.Note: the response of the get\
        \ request contains fields that do not exist in the list command, make sure to\
        \ add them to the yaml file as well."
      name: submission_uuid
    - description: |
        Filter submissions by start date
      name: date_start
    - description: |
        Filter submissions by end date
      name: date_end
    - description: |
        ''
      name: source_name
    - description: |
        ''
      name: state
    - description: |
        ''
      name: submission_reason
    - description: |
        ''
      name: submitter_email
    - description: |
        Default 50API argument - page_size
      name: limit
    - description: |
        API argument - marker
      name: next_token
    - description: |
        ''
    outputs: []
  - name: 'netcraft-submission-file-list'
    arguments:
    - description: |
        "Add description that the user can get this value by running the\
        \ command \u201Csubmission-list\u201D."
      name: submission_uuid
      required: true
    - description: |
        Default 50API argument - count
      name: limit
    - description: |
        ''
      name: page
    - description: |
        Default 50API argument - count
      name: page_size
    description: |
      ''
    outputs: []
  - name: 'netcraft-file-screenshot-get'
    arguments:
    - description: |
        "Add description that the user can get this value by running the\
        \ command \u201Csubmission-list\u201D."
      name: submission_uuid
      required: true
    - description: |
        "Add description that the user can get this value by running the\
        \ command \u201Csubmission-file-list\u201D."
      name: file_hash
      required: true
    description: |
      ''
    outputs: []
  - name: 'netcraft-submission-mail-list'
    arguments:
    - description: |
        Note
      name: Argument name
    - description: |
        "Add description that the user can get this value by running the\
        \ command \u201Csubmission-list\u201D."
      name: submission_uuid
      required: true
    description: |
      ''
    outputs: []
  - name: 'netcraft-mail-screenshot-get'
    arguments:
    - description: |
        Note
      name: Argument name
    - description: |
        "Add description that the user can get this value by running the\
        \ command \u201Csubmission-list\u201D."
      name: submission_uuid
      required: true
    description: |
      ''
    outputs: []
  - name: 'netcraft-submission-url-list'
    arguments:
    - description: |
        Note
      name: Argument name
    - description: |
        "Add description that the user can get this value by running the\
        \ command \u201Csubmission-list\u201D."
      name: submission_uuid
      required: true
    - description: |
        Default 50API argument - count
      name: limit
    - description: |
        ''
      name: page
    - description: |
        Default 50API argument - count
      name: page_size
    description: |
      ''
    outputs: []
  - name: 'netcraft-url-screenshot-get'
    arguments:
    - description: |
        Note
      name: Argument name
    - description: |
        "Add description that the user can get this value by running the\
        \ command \u201Csubmission-list\u201D."
      name: submission_uuid
      required: true
    - description: |
        "Add description that the user can get this value by running the\
        \ command \u201Csubmission-URL-list\u201D."
      name: url_uuid
      required: true
    - description: |
        "An MD5 hash of the screenshot in question.Add description that the\
        \ user can get this value by running the command \u201Csubmission-URL-list\u201D\
        ."
      name: screenshot_hash
      required: true
    description: |
      ''
    outputs: []
  script: '-'
  type: python
  dockerimage: demisto/python3:3.10.12.63474
  subtype: python3
  isfetch: true
  ismappable: true
  isremotesyncin: true
  isremotesyncout: true
  runonce: false
fromversion: 6.9.0
tests:
- No tests (deprecated)
defaultmapperin: Netcraft Incoming Mapper
defaultmapperout: Netcraft Outgoing Mapper